<!-- (C) 2010 Nesterenkov Sergey, BSUIR -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<LINK rel=stylesheet href="../../../Оболочка/css/style2.css" type=text/css>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META HTTP-EQUIV="Content-Language" CONTENT="ru">
<title>Теория по дисциплине &quot;Программирование проблемно-ориентированных вычислительных средств реального времени&quot;</title>
<base target="_top">

<base target="_self">
<style type="text/css">
body,td,th { font-family: Times New Roman, Times, serif; }
p {margin-left: 5%; margin-right: 5%; }
</style></HEAD>

</HEAD><BODY>
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" background="../../../Оболочка/images/background.jpg">
  <tr> 
    <td width="13%" rowspan=3 align="center" ><img src="../../../Оболочка/images/logo_new.jpg" width=117 align="middle"></td>
  <tr> 
    <td width="70%" colspan=2 align="center" valign="middle"> <H1 align="center" >&nbsp;</H1>
      <H1 align="center" >Электронный ресурс по учебной дисциплине<BR>
        "Программирование проблемно-ориентированных вычислительных средств реального времени"<BR> 
        для специальности: </H1>
<p>1-40 02 02 "Электронные вычислительные средства"
</p></td>
    <td width="12%" rowspan=3 align="center" ><img src="../../images/theory.jpg" width="146" height="85"></td>
  <Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> | <A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <tr>
</table></div>



<!--start-->
	<div class="mainTitle" align="center">
	  <h1>Лекция № 2.10</h1>
</div>
	<div>
	  <h3 align="center"><strong>Раздел 2.  Программная реализация основных алгоритмов цифровой обработки сигналов:  формирование сигналов, цифровая фильтрация, быстрое преобразование Фурье</strong>      </h3>
      <p><strong>2.2&nbsp;&nbsp;&nbsp; Программирование цифровых фильтров (8 часов)</strong><br>
        <strong><em>Лекция № 2.10</em></strong><br>
        Параллельное и последовательное  соединение цифровых рекурсивных фильтров. Распределение памяти данных.  Циклическое программирование ЦРФ.<br>
      </p>
</div>


<div align="center">
    <p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK09/lk_09.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK11/lk_11.htm'" />
    </p>
</div>

<!-- (C) 2017 Shemarov Alexander, BSUIR begin-->  

	<div class="Text_Style"><h1>Параллельное и последовательное соединение цифровых фильтров</h1>
	<h2>Построение сложных цифровых фильтров из простых звеньев</h2></div>
 	<div class="Text_Style">
	  <p>Сложный  фильтр высокого порядка (рис.&nbsp;2.2.6) может быть реализован с помощью комбинации простых полосовых  или режекторных фильтров (обычно 2-го порядка). При этом полосовые фильтры соединяются параллельно (рис.&nbsp;2.2.7) и их выходные сигналы суммируются, а режекторные фильтры соединяются последовательно (рис.&nbsp;2.2.8) и каждый следующий вычитает из сигнала свою составляющую.<br></p>
<h3 align="center"><a name="fig1"></a><img src="../../images/ris010203_a.gif" alt="Рис.2.2.6" width="184" height="148"></h3>
<h3 align="center">Рисунок 2.2.6 &ndash; Передаточная характеристика цифрового фильтра<br></h3>
<h3 align="center"><a name="fig2"></a><img src="../../images/ris010203_b.gif" alt="Рис.2.2.7" width="680" height="267"></h3>
<h3 align="center">Рисунок 2.2.7 &ndash; Параллельное соединение фильтров<br></h3>
<h3 align="center"><a name="fig3"></a><img src="../../images/ris010203_c.gif" alt="Рис.2.2.8" width="680" height="239"></h3>
<h3 align="center">Рисунок 2.2.8 &ndash; Последовательное соединение фильтров<br></h3>
	</div>
	<div class="Text_Style"><h2>Параллельное соединение цифровых фильтров 2-го порядка</h2></div>
	<div class="Text_Style">
      <p>Передаточная функция ЦРФ при параллельном соединении  фильтров 2-го порядка описывается уравнением:</p>
      <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010203_a.gif" alt="Фор.3.a" width="470" height="71"><br></td>
          <td width="10%" valign="center" align="right">&nbsp;</td>
        </tr>
      </table>
<p>Если N &lt; M, то  первая сумма равна нулю, а для N = M она равна C.<br>
Уравнение одного фильтра во временной области в  канонической форме записывается как</p>
      <table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center">		d<sub>k</sub>(n) = x(n) &ndash; &beta;<sub>1k</sub> d<sub>k</sub>(n-1) &ndash; &beta;<sub>2k</sub> d<sub>k</sub>(n-2)<br>
		p<sub>k</sub>(n)  = &alpha;<sub>0k</sub> d<sub>k</sub>(n) + &alpha;<sub>1k</sub> d<sub>k</sub>(n-1)<br></td>
          <td width="10%" valign="center" align="right">&nbsp;</td>
        </tr>
      </table>
<p>а выходное значение для всех  фильтров (при N = M = 2<sup>m+1</sup>)</p>
      <table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010203_b.gif" alt="Фор.3.b" width="208" height="69"><br></td>
          <td width="10%" valign="center" align="right">&nbsp;</td>
        </tr>
      </table>
<p>Структуру такого фильтра для m=2 представлена на рисунке 2.2.9.<br></p>
<h3 align="center"><a name="fig4"></a><img src="../../images/ris010203_d.gif" alt="Рис.2.2.9" width="595" height="525"></h3>
<h3 align="center">Рисунок 2.2.9 &ndash; Параллельное соединение двух ЦРФ 2-го порядка</h3>
      <p>Промежуточные данные в памяти рекомендуется располагать следующим образом (рис.&nbsp;2.2.10):</p>
<h3 align="center"><a name="fig5"></a><img src="../../images/ris010203_e.gif" alt="Рис.2.2.10" width="555" height="232"></h3>
<h3 align="center">Рисунок 2.2.10 &ndash; Расположение промежуточных данных в памяти</h3>
<p align="center">&nbsp;</p>
</div>
	<div class="Text_Style"><h2>Последовательное соединение цифровых фильтров 2-го порядка</h2>
	  <p>&nbsp;</p>
	</div>
	<div class="Text_Style">
      <p>Передаточная функция ЦРФ при  последовательном соединении описывается уравнением</p>
      <table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010203_c.gif" alt="Фор.2.8" width="309" height="62"><br></td>
          <td width="10%" valign="center" align="right">(2.2.8)</td>
        </tr>
      </table>
      <p>Уравнение одного фильтра во временной области в канонической форме записывается как</p>
      <table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center">			d<sub>k</sub>(n) = y<sub>k-1</sub>(n) &ndash; &beta;<sub>1k</sub> d<sub>k</sub>(n-1) &ndash; &beta;<sub>2k</sub> d<sub>k</sub>(n-2) ,<br>
			y<sub>k</sub>(n) = &alpha;<sub>0k</sub> d<sub>k</sub>(n) + &alpha;<sub>1k</sub> d<sub>k</sub>(n-1) + &alpha;<sub>2k</sub> d<sub>k</sub>(n-2) ,<br><br></td>
          <td width="10%" valign="center" align="right">(2.2.9)</td>
        </tr>
      </table>
      <p>где  k изменяется от 1 до (М-1)/2. Входное значение y<sub>0</sub>(n) = x(n), выходное значение y<sub>(M-1)/2</sub>(n) = y(n), а структура такого  фильтра для двух каскадов представлена в следующем виде (рис.&nbsp;2.2.11).<br></p>
<h3 align="center"><a name="fig6"></a><img src="../../images/ris010203_f.gif" alt="Рис.2.11" width="535" height="180"></h3>
<h3 align="center">Рисунок 2.2.11 &ndash; Последовательное соединение двух ЦРФ 2-го порядка (каноническая форма)</h3>
      <p>Промежуточные данные d<sub>k</sub>(n-i) в памяти располагаются аналогично предыдущему случаю.<br>
      Для прямой формы  реализации структура этого же фильтра выглядит следующим образом (рис.&nbsp;2.2.12):<br></p>
<h3 align="center"><a name="fig7"></a><img src="../../images/ris010203_g.gif" alt="Рис.2.2.12" width="592" height="171"></h3>
<h3 align="center">Рисунок 2.2.12 &ndash; Последовательное соединение двух ЦРФ 2-го порядка (прямая форма)</h3>
      <p>Учитывая, что  данные предыстории между каскадами совпадают<br>
        (y<sub>1</sub>(n-k)=x<sub>1</sub>(n-k)), структура фильтра может быть  преобразована к следующему виду (рис.&nbsp;2.13).<br></p>
<h3 align="center"><a name="fig8"></a><img src="../../images/ris010203_h.gif" alt="Рис.2.2.13" width="532" height="172"></h3>
<h3 align="center">Рисунок 2.2.13 &ndash; Последовательное соединение двух ЦРФ 2-го порядка (модифицированная прямая форма)</h3>
      <p>При такой реализации сразу  исчезает недостаток прямой формы, связанный с двойным количеством ячеек  предыстории. В данной реализации общее число ячеек предыстории при прямой форме  только на 3 больше, чем при канонической. При программной реализации такого  фильтра необходимо учитывать то, что сдвигать по памяти нужно только отсчеты  предыстории входных значений, поскольку выходные значения будут сдвинуты при  работе следующего каскада (в котором они становятся входными) и только после  последнего каскада необходимо сдвинуть два значения y(n-1) и y(n).</p>
      <p>&nbsp;</p>
</div>
	<div class="Text_Style">
	  <h2>Примеры программной реализации параллельного и последовательного соединения цифровых рекурсивных фильтров	<br></h2>
	</div>
	<div class="Text_Style">
	<p>Ниже приведены примеры программ для параллельного и последовательного соединения ЦРФ.</p>
	<blockquote>
	  <blockquote>
	    <h4>	; Линейная программа ЦРФ (каноническая форма) 4-го порядка<br>
	      ; с параллельным соединением 2-х каскадов
        </h4>
	    <pre>	.data	
D2N	.WORD	0
D2NM1	.WORD	0
D2NM2	.WORD	0
D1N	.WORD	0
D1NM1	.WORD	0
D1NM2	.WORD	0
A01	.WORD	0
A11	.WORD	0
B11	.WORD	0
B21	.WORD	0
A02	.WORD	0
A12	.WORD	0
B12	.WORD	0
B22	.WORD	0
C	.WORD	0
XN	.WORD	0
	.text
START	LD	#XN, DP	; текущая страница с XN
	SSBX	FRCT	; режим умножения дробных чисел
	RSBX	OVM	; нет коррекции переполнения в АЛУ
	ORM	#1, PMST	; коррекция переполнения при записи
	STM	#D2NM1, AR2	; AR2:= адрес d(n-(N-1))
	RPTZ	A, #4	; А:=0 и повторить 5 раз
	STL	A, *AR2+	; обнуление предыстории di(n-k):=0
	RPT	#9-1	; повторить 9 раз, AR2:= адрес a01
	MVPD	CA01, *AR2+	; пересылка коэффициентов
WAIT	BC	WAIT, BIO	; ожидание готовности
	PORTR	PA2, XN	; ввод из порта x(n)
	; вычисление d1(n)
	LD	XN, 16, A	; x(n) в старшую часть акк.А
	LD	D1NM2, T	; Т:=d1(n-2)
	MAS	B21, A	; A:=A-T*b21=A-b21*d1(n-2)
	LTD	D1NM1	; T:=d1(n-1), d1(n-1)->d1(n-2)
	MASR	B11, A	; A:=A-T*b11=A-b11*d1(n-1) и округ.
	STH	A, D1N	; d1(n)
	; вычисление p1(n)
	MPY	A11, B	; B:=T*a11=a11*d1(n-1)
	LTD	D1N	; T:=d1(n), d1(n)->d1(n-1)
	MAC	A01, B	; B:=B+T*a01=B+a01*d1(n)=p1(n)
	; вычисление d2(n)
	LD	XN, 16, A	; x(n) в старшую часть акк.А
	LD	D2NM2, T	; Т:=d2(n-2)
	MAS	B22, A	; A:=A-T*b22=A-b22*d2(n-2)
	LTD	D2NM1	; T:=d2(n-1), d2(n-1)->d2(n-2)
	MASR	B12, A	; A:=A-T*b12=A-b12*d2(n-1) и округ.
	STH	A, D2N	; d2(n)
	; вычисление p2(n)
	MAC	A12, B	; B:=B+T*a12=B+a12*d2(n-1)
	LTD	D2N	; T:=d2(n), d2(n)->d2(n-1)
	MAC	A02, B	; B:=B+T*a02=B+a02*d2(n)=p2(n)
	
; вычисление y(n)
	LD	XN, T	; T:=x(n)
	MACR	C, B	; B:=B+T*C=B+C*x(n)=y(n) и округ.
	STH	B, XN	; y(n)->x(n)
	BD	WAIT	; задержанный переход на WAIT
	PORTW	XN, PA2	;2w вывод в порт y(n)
; коэффициенты в памяти программ
CA01	.WORD	0C750h	;-0.4428446
CA11	.WORD	05F2Ch	; 0.7435591
CB11	.WORD	0394Dh	; 0.447687
CB21	.WORD	0D889h	;-0.308310
CA02	.WORD	0F721h	;-0.0693031
CA12	.WORD	0EFAEh	;-0.1274959
CB12	.WORD	0FEF7h	;-0.008080
CB22	.WORD	090EEh	;-0.867723
CC	.WORD	05988h	; 0.699476</pre>
	    <h4>	  ; Линейная программа ЦРФ (каноническая форма) 4-го порядка<br>
	      ; с последовательным соединением 2-х каскадов
        </h4>
	    <pre>	.data	
D2N	.WORD	0
	.  .  .
D1NM2	.WORD	0
A01	.WORD	0
A11	.WORD	0
A21	.WORD	0
B11	.WORD	0
B21	.WORD	0
A02	.WORD	0
	.  .  .
B22	.WORD	0
XN	.WORD	0
	.text
START	LD	#XN, DP	; текущая страница с XN
	SSBX	FRCT	; режим умножения дробных чисел
	RSBX	OVM	; нет коррекции переполнения в АЛУ
	ORM	#1, PMST	; коррекция переполнения при записи
	STM	#D2NM1, AR2	; AR2:= адрес d(n-(N-1))
	RPTZ	A, #4	; А:=0 и повторить 5 раз
	STL	A, *AR2+	; обнуление предыстории di(n-k):=0
	RPT	#10-1	; повторить 10 раз, AR2:=адрес a01
	MVPD	CA01, *AR2+	; пересылка коэффициентов
WAIT	BC	WAIT, BIO	; ожидание готовности
	PORTR	PA2, XN	; ввод из порта x(n)
	; вычисление d1(n)
	LD	XN, 16, A	; x(n) в старшую часть акк.А
	LD	D1NM1, T	; Т:=d1(n-1)
	MAS	B11, A	; A:=A-T*b11=A-b11*d1(n-1)
	LD	D1NM2, T	; T:=d1(n-2)
	MASR	B21, A	; A:=A-T*b21=A-b21*d1(n-2)=d1(n)
	STH	A, D1N	; d1(n)
	; вычисление y1(n)
	MPY	A21, A	; A:=T*a21=a21*d1(n-2)
	LTD	D1NM1	; T:=d1(n-1), d1(n-1)->d1(n-2)
	MAC	A11, A	; A:=A+T*a11=A+a11*d1(n-1)
	LTD	D1N	; T:=d1(n), d1(n)->d1(n-1)
	MAC	A01, A	; A:=A+T*a01=A+a01*d1(n)=y1(n)
	; вычисление d2(n)
	LD	D2NM1, T	; Т:=d2(n-1)
	MAS	B12, A	; A:=A-T*b12=A-b12*d2(n-1)
	LD	D2NM2, T	; T:=d1(n-2)
	MASR	B22, A	; A:=A-T*b22=A-b22*d2(n-2)=d2(n)
	STH	A, D2N	; d2(n)
	; вычисление y(n)
	MPY	A22, A	; A:=T*a22=a22*d2(n-2)
	LTD	D2NM1	; T:=d2(n-1), d2(n-1)->d2(n-2)
	MAC	A12, A	; A:=A+T*a12=A+a12*d2(n-1)
	LTD	D2N	; T:=d2(n), d2(n)->d2(n-1)
	MAC	A02, A	; A:=A+T*a02=A+a02*d2(n)=y(n)
	STH	B, XN	; y(n)->x(n)
	BD	WAIT	; задержанный переход на WAIT
	PORTW	XN, PA2	;2w вывод в порт y(n)
; коэффициенты в памяти программ
CA01	.WORD	01F05h	; 0.242342
CA11	.WORD	02B75h	; 0.339521
CA21	.WORD	01EFDh	; 0.242117
CB11	.WORD	0394Dh	; 0.447687
CB21	.WORD	0D889h	;-0.308310
CA02	.WORD	062F1h	; 0.772990
CA12	.WORD	026DBh	; 0.303581
CA22	.WORD	062EDh	; 0.772887
CB12	.WORD	0FEF7h	;-0.008080
CB22	.WORD	090EEh	;-0.867723
	</pre>
      </blockquote>
	  </blockquote>
</div>
<!-- (C) 2017 Shemarov Alexander, BSUIR end-->  

<div align="center">
	<p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK09/lk_09.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK11/lk_11.htm'" />
    </p>
  
<div class="Text_Style"><br></div>
</div>


<!--end-->
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" bordercolor="#316AC5" background="../../../Оболочка/images/background.jpg">
	<Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> |<A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <Tr>
   <td align=center><a href="https://www.bsuir.by/" title="Официальный сайт БГУИР" target="_blank">(С) БГУИР</a></td>
  </tr>
</table></div>


</BODY></HTML>