<!-- (C) 2010 Nesterenkov Sergey, BSUIR -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<LINK rel=stylesheet href="../../../Оболочка/css/style2.css" type=text/css>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META HTTP-EQUIV="Content-Language" CONTENT="ru">
<title>Теория по дисциплине &quot;Программирование проблемно-ориентированных вычислительных средств реального времени&quot;</title>
<base target="_top">

<base target="_self">
<style type="text/css">
body,td,th { font-family: Times New Roman, Times, serif; }
p {margin-left: 5%; margin-right: 5%; }
</style></HEAD>

</HEAD><BODY>
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" background="../../../Оболочка/images/background.jpg">
  <tr> 
    <td width="13%" rowspan=3 align="center" ><img src="../../../Оболочка/images/logo_new.jpg" width=117 align="middle"></td>
  <tr> 
    <td width="70%" colspan=2 align="center" valign="middle"> <H1 align="center" >&nbsp;</H1>
      <H1 align="center" >Электронный ресурс по учебной дисциплине<BR>
        "Программирование проблемно-ориентированных вычислительных средств реального времени"<BR> 
        для специальности: </H1>
<p>1-40 02 02 "Электронные вычислительные средства"
</p></td>
    <td width="12%" rowspan=3 align="center" ><img src="../../images/theory.jpg" width="146" height="85"></td>
  <Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> | <A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <tr>
</table></div>



<!--start-->
	<div class="mainTitle" align="center">
	  <h1>Лекция № 2.12</h1>
</div>
	<div>
	  <h3 align="center"><strong>Раздел 2.  Программная реализация основных алгоритмов цифровой обработки сигналов:  формирование сигналов, цифровая фильтрация, быстрое преобразование Фурье</strong>      </h3>
      <p><strong>2.3&nbsp;&nbsp;&nbsp; Программирование базовых операций алгоритмов  быстрого преобразования Фурье (БПФ) (4 часа)</strong><br>
        <strong><em>Лекция № 2.12</em></strong><br>
        Программная реализация различных типов  базовых операций алгоритмов БПФ для процессоров семейства TMS320. Использование  команд умножение с накоплением.<br>
      </p>
</div>


<div align="center">
    <p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK11/lk_11.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK13/lk_13.htm'" />
    </p>
</div>

<!-- (C) 2017 Shemarov Alexander, BSUIR begin-->  

	<div class="Text_Style"><h1>Реализация базовых операций алгоритмов быстрого преобразования Фурье (БПФ)</h1>
    <h2>Два основных алгоритма БПФ</h2></div>
 	<div class="Text_Style">
	  <p>Алгоритм БПФ с  прореживанием по времени с учетом симметрии поворачивающих множителей <strong><em>W</em></strong> можно описать следующими  уравнениями:</p>
      <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010301_a.gif" alt="Фор.3.1" width="365" height="64"><br></td>
          <td width="10%" valign="center" align="right">(2.3.1)</td>
        </tr>
      </table>
      <p>где <em>F<sub>K</sub></em> &ndash; БПФ исходной  последовательности; <em>G<sub>K</sub></em> и <em>H<sub>K</sub></em> &ndash; БПФ последовательностей из четных и нечетных  элементов соответственно, а</p>
      <table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010301_b.gif" alt="Фор.3.2" width="391" height="63"><br></td>
          <td width="10%" valign="center" align="right">(2.3.2)</td>
        </tr>
      </table>
      <p>поворачивающие множители.<br>
        Суть  алгоритма БПФ с прореживанием по времени заключается в разбиении входной  последовательности на четные и нечетные элементы, выполнение над ними БПФ в два  раза меньшей размерности и объединение полученных результатов снова в одну  последовательность по формулам (2.3.1) (рис.&nbsp;2.3.1).<br></p>
<h3 align="center"><a name="fig1"></a><img src="../../images/ris010301_a.gif" alt="Рис.3.1" width="384" height="215"></h3>
<h3 align="center">Рисунок 2.3.1 &ndash; Принцип БПФ с прореживанием по времени</h3>
	<p>Положение поворачивающих множителей на Z–плоскости можно изобразить в виде следующего рисунка (особые случаи для степеней кратных N/8):</p>
	</div>
<h3 align="center"><a name="fig2"></a><img src="../../images/ris010301_b.png" alt="Рис.3.2" width="640" height="270"></h3>
<h3 align="center">Рисунок 2.3.2 &ndash; Положение поворачивающих множителей на Z–плоскости</h3>
	<p>Функция поворачивающих множителей является симметричной и  периодической, что следует из выражения (2.3.2) и наглядно видно из рисунка 2.3.2:</p>
<table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010301_c.gif" alt="Фор.3.3" width="245" height="30"><br></td>
          <td width="10%" valign="center" align="right">(2.3.3)</td>
        </tr>
      </table>
	  <p>Алгоритм БПФ с прореживанием по частоте описывается следующими  уравнениями:</p>
<table align="center" width="80%"  border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for010301_d.gif" alt="Фор.3.4" width="195" height="59"><br></td>
          <td width="10%" valign="center" align="right">(2.3.4)</td>
        </tr>
      </table>
      <p>Суть БПФ с прореживанием по частоте заключается в разбиении входной последовательности на две по формулам (2.3.4) и выполнении над ними БПФ в два раза меньшей  размерности, что можно проиллюстрировать рисунком (для 8-точечного БПФ) (рис.&nbsp;2.3.3).<br></p>
<h3 align="center"><a name="fig3"></a><img src="../../images/ris010301_c.gif" alt="Рис.3.3" width="384" height="215"></h3>
<h3 align="center">Рисунок 2.3.3 &ndash; Принцип БПФ с прореживанием по частоте</h3>
    <p>Выражения (2.3.1) и (2.3.4) описывают базовые операции алгоритмов БПФ с  прореживанием по времени и частоте соответственно, которые иногда называют  &laquo;бабочкой&raquo; из-за их графической интерпретации (рис.&nbsp;2.3.4):<br>
<h3 align="center"><a name="fig4"></a><img src="../../images/ris010301_d.gif" alt="Рис.3.4" width="591" height="118"></h3>
<h3 align="center">Рисунок 2.3.4 &ndash; Графическая интерпретация базовых операций БПФ</h3>
    <p>Используя данные  обозначения, базовые  операции алгоритмов БПФ с прореживанием по времени и частоте могут быть  представлены в следующим виде (рис.&nbsp;2.3.5):<br>
<h3 align="center"><a name="fig5"></a><img src="../../images/ris010301_e.gif" alt="Рис.3.5" width="610" height="553"></h3>
<h3 align="center">Рисунок 2.3.5 &ndash; Графические представления &laquo;бабочек&raquo; БПФ</h3>
	<div class="Text_Style"><h2>Вычисление «бабочки» для алгоритма БПФ с прореживанием по времени</h2></div>
	<div class="Text_Style">
      <p>Поскольку процессор TMS320VC5402 не имеет команд для работы с комплексными числами, то  действительная и мнимая части комплексного числа хранятся в паре соседних ячеек  памяти, и все операции с ними выполняются отдельно. С учетом раздельного  выполнения операций над действительной и мнимой частями двух элементов  &laquo;бабочки&raquo; (переменные <strong><em>P</em></strong> и <strong><em>Q</em></strong>) алгоритм вычисления &laquo;бабочки&raquo;  для БПФ с замещением и прореживанием по времени можно записать в следующем  виде:<br>
	<div align="center">
	<em>P<sub>m+1</sub> = P<sub>m</sub> + Q<sub>m</sub></em>&times;<em>W<sub>N</sub></sup>k</sup></em>,<br>
	<em>Q<sub>m+1</sub> = P<sub>m</sub> &ndash; Q<sub>m</sub></em>&times;<em>W<sub>N</sub></sup>k</sup></em>,
	</div>
        <p>где <em>P<sub>m</sub></em> = <em>PR</em> + <em>j</em>&times;<em>PI</em>; <em>Q</sub>m</sub></em> = <em>QR</em> + <em>j</em>&times;<em>QI</em>; <em>W<sub>N</sub></sup>k</sup></em> = cos(<em>x</em>) &ndash; <em>j</em>&times;sin(<em>x</em>); <em>x</em> = (2&Pi;/<em>N</em>)&times;<em>k</em>; <em>j</em> = <img src="../../images/for010301_k.gif" alt="Корень" width="33" height="23">; </p>
        <p>откуда получаем <br>
	      <em>P<sub>m+1</sub></em> = <em>PR + j</em>&times;<em>PI + </em>(<em>QR + j</em>&times;<em>QI</em>)&times;[cos(<em>x</em>)<em> &ndash; j</em>&times;sin(<em>x</em>)] =<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <em>PR + j</em>&times;<em>PI + </em>[<em>QR</em>&times;cos(<em>x</em>)<em> + QI</em>&times;sin(<em>x</em>)]<em> + j</em>&times;[<em>QI</em>&times;cos(<em>x</em>)<em> &ndash; QR</em>&times;sin(<em>x</em>)] =<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<em><u>PR + QR</u></em><u>&times;</u><u>cos(<em>x</em>)<em> + QI</em></u><u>&times;</u><u>sin(<em>x</em>)</u>]<em> + j</em>&times;[<em><u>PI +QI</u></em><u>&times;</u><u>cos(<em>x</em>)<em> &ndash; QR</em></u><u>&times;</u><u>sin(<em>x</em>)</u>];</p>
<p><br>
          <em>Q<sub>m+1</sub></em> = </em>PR + j</em>&times;<em>PI &ndash; </em>(<em>QR + j</em>&times;<em>QI</em>)&times;[cos(<em>x</em>)<em> &ndash; j</em>&times;sin(<em>x</em>)] =<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <em>PR + j</em>&times;<em>PI &ndash; </em>[<em>QR</em>&times;cos(<em>x</em>)<em> + QI</em>&times;sin(<em>x</em>)]<em> &ndash; j</em>&times;[<em>QI</em>&times;cos(<em>x</em>)<em> &ndash; QR</em>&times;sin(<em>x</em>)] =<br>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<em><u>PR &ndash; QR</u></em><u>&times;</u><u>cos(<em>x</em>)<em> &ndash; QI</em></u><u>&times;</u><u>sin(<em>x</em>)</u>]<em> + j</em>&times;[<em><u>PI &ndash;QI</u></em><u>&times;</u><u>cos(<em>x</em>)<em> + QR</em></u><u>&times;</u><u>sin(<em>x</em>)</u>].</p>
   
     <p>При вычислении «бабочки» для исключения переполнения все выходные значения делятся на два.</p>
	<blockquote>
	  <blockquote>
	    <h4><br>
	    ; Пример программы с прямой адресацией вычисления «бабочки» для алгоритма БПФ<br>
	    ; с замещением и прореживанием по времени: <br>
	    </h4>
	    <pre>* DIT FFT Programm for TMS320C5402 DSP Starter Kit 
* Direct Addressing	12/11/09 20:20:00
	.data
*	данные
PR	.word	0h	; действительная часть P
PI	.word	0h	; мнимая часть P
QR	.word	0h	; действительная часть Q
QI	.word	0h	; мнимая часть Q
COS	.word	0h	; действительная часть W
SIN	.word	0h	; мнимая часть W
	.text
*	инициализация
INIT	ld	#PR, DP	; текущая страница данных
	ssbx	sxm	; расширение знака
	ssbx	frct	; умножение дробных чисел
*	«бабочка»
BTRFLY	ld	QR, T	; T = QR
	mpy	COS, a	; A = QR*cos
	ld	QI, T	; T = QI
	mac	SIN, a	; A = QR*cos+QI*sin = XR
	mpy	COS, b	; B = QI*cos
	ld	QR, T	; T = QR
	sth	a, QR	; QR = a = XR
	mas	SIN, b	; B = QI*cos-QR*sin = XI
	sth	b, QI	; QI = b = XI
	ld	PI, 15, a	; A = 1/2 PI
	add	QI, 15, a	; A = 1/2 (PI+XI)
	sth	a, PI	; PI = 1/2 new PI
	sub	QI, 16, a	; A = 1/2 (PI-XI)
	sth	a, QI	; QI = 1/2 new QI
	ld	QR, 15, a	; A = 1/2 XR
	add	PR, 15, a	; A = 1/2 (PR+XR)
	sth	a, PR	; PR = 1/2 new PR
	sub	QR, 16, a	; A = 1/2 (PR-XR)
	sth	a, QR	; QR = 1/2 new QR
	    </pre>
      </blockquote>
	  </blockquote>
</div>
	<div class="Text_Style">
	  <h2>Вычисление «бабочки» для алгоритма БПФ с прореживанием по частоте</h2></div>
  <div class="Text_Style">
       <p>С учетом раздельного выполнения операций над  действительной и мнимой частями переменных <strong><em>P</em></strong> и <strong><em>Q</em></strong> алгоритм вычисления &laquo;бабочки&raquo;  для БПФ с замещением и прореживанием по частоте может быть записан следующим  образом:<br>
	<div align="center">
  <em>P<sub>m+1</sub></em> = <em>P<sub>m</sub> + Q<sub>m</sub> </em>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
  <em>Q<sub>m+1</sub></em> = (<em>P<sub>m</sub>  &ndash; Q<sub>m</sub></em>)&times;<em>W<sub>N</sub></sup>k</sup></em>,<br>
	</div>
    <p>выразив который через действительные и мнимые составляющие получим</p>
    <p><em>P<sub>m+1</sub></em> = <em>PR + j</em>&times;<em>PI + QR + j</em>&times;<em>QI = </em>[<em><u>PR + QR</u></em>]<em> + j</em>&times;[<em><u>PI + QI</u></em>];</p>
    <p><em>Q<sub>m+1</sub></em> = (<em>PR + j</em>&times;<em>PI &ndash; QR &ndash; j</em>&times;<em>QI</em>)&times;[cos(<em>x</em>)<em> &ndash; j</em>&times;sin(<em>x</em>)] =<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <em>PR</em>&times;<em>cos(x)  + j</em>&times;<em>PI</em>&times;cos(<em>x</em>)<em> &ndash; QR</em>&times;cos(<em>x</em>)<em> &ndash; j</em>&times;<em>QI</em>&times;cos(<em>x</em>) &ndash;<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&ndash; <em>j</em>&times;<em>PR</em>&times;sin(<em>x</em>)<em> + PI</em>&times;sin(<em>x</em>)<em> + j</em>&times;<em>QR</em>&times;sin(<em>x</em>)<em> &ndash; QI</em>&times;sin(<em>x</em>) =<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [<u>(<em>PR &ndash; QR</em>)</u><u>&times;</u><u>cos(<em>x</em>)<em> + </em>(<em>PI &ndash; QI</em>)</u><u>&times;</u><u>sin(<em>x</em>)</u>]<em> + j</em>&times;<u>(<em>PI &ndash;QI</em>)</u><u>&times;</u><u>cos(<em>x</em>)<em> &ndash; </em>(<em>PR &ndash; QR</em>)</u><u>&times;</u><u>sin(<em>x</em>)</u>].</p>
  	<p>
  	При вычислении «бабочки» для исключения переполнения все выходные значения делятся на два.</p>
<blockquote>
  <blockquote>
      <pre><h4>
; Пример программы с прямой адресацией вычисления «бабочки» для алгоритма БПФ
; с замещением и прореживанием по частоте:</h4>
* DIF FFT Programm for TMS320C5402 DSP Starter Kit 
* Direct Addressing	12/11/09 20:30:00
	.data
*	данные
PR	.word	0h	; действительная часть P
PI	.word	0h	; мнимая часть P
QR	.word	0h	; действительная часть Q
QI	.word	0h	; мнимая часть Q
COS	.word	0h	; действительная часть W
SIN	.word	0h	; мнимая часть W
	.text
*	инициализация
INIT	ld	#PR, DP	; текущая страница данных
	ssbx	sxm	; расширение знака
	ssbx	frct	; умножение дробных чисел
*	«бабочка»
BTRFLY	ld	PR, 15, a	; A = 1/2 PR
	add	QR, 15, a	; A = 1/2 (PR+QR)
	sth	a, PR	; PR = 1/2 new PR
	sub	QR, 16, a	; A = XR = 1/2 (PR-QR)
	sth	a, QR	; QR = a = XR
	ld	QI, 15, a	; A = 1/2 QI
	add	PI, 15, a	; A = 1/2 (PI+QI)
	sth	a, PI	; PI = 1/2 new PI
	sub	QI, 16, a	; A = XI = 1/2 (PI-QI)
	sth	a, QI	; QI = a = XI
	ld	QR, T	; T = QR = 1/2 (PR-QR)
	mpy	COS, a	; A = 1/2 (PR-QR)*cos
	ld	QI, T	; T = QI = 1/2 (PI-QI)
	mac	SIN, a	; A =1/2[(PR-QR)cos+(PI-QI)sin]
	mpy	COS, b	; B = 1/2 (PI-QI)*cos
	ld	QR, T	; T = QR = 1/2 (PR-QR)
	sth	a, QR	; QR = 1/2 new QR
	mas	SIN, b	; B =1/2[(PI-QI)cos-(PR-QR)sin]
	sth	b, QI	; QI = 1/2 new QI
	</pre>
    </blockquote>
    </blockquote>
</div>

<div align="center">
 	<p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK11/lk_11.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK13/lk_13.htm'" />
  </p>
  
<div class="Text_Style"><br></div>
</div>



<!--end-->
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" bordercolor="#316AC5" background="../../../Оболочка/images/background.jpg">
	<Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> |<A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <Tr>
   <td align=center><a href="https://www.bsuir.by/" title="Официальный сайт БГУИР" target="_blank">(С) БГУИР</a></td>
  </tr>
</table></div>



</BODY></HTML>