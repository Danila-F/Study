<!-- (C) 2010 Nesterenkov Sergey, BSUIR -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<LINK rel=stylesheet href="../../../Оболочка/css/style2.css" type=text/css>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META HTTP-EQUIV="Content-Language" CONTENT="ru">
<title>Теория по дисциплине &quot;Программирование проблемно-ориентированных вычислительных средств реального времени&quot;</title>
<base target="_top">

<base target="_self">
<style type="text/css">
body,td,th { font-family: Times New Roman, Times, serif; }
p {margin-left: 5%; margin-right: 5%; }
</style></HEAD>

</HEAD><BODY>
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" background="../../../Оболочка/images/background.jpg">
  <tr> 
    <td width="13%" rowspan=3 align="center" ><img src="../../../Оболочка/images/logo_new.jpg" width=117 align="middle"></td>
  <tr> 
    <td width="70%" colspan=2 align="center" valign="middle"> <H1 align="center" >&nbsp;</H1>
      <H1 align="center" >Электронный ресурс по учебной дисциплине<BR>
        "Программирование проблемно-ориентированных вычислительных средств реального времени"<BR> 
        для специальности: </H1>
<p>1-40 02 02 "Электронные вычислительные средства"
</p></td>
    <td width="12%" rowspan=3 align="center" ><img src="../../images/theory.jpg" width="146" height="85"></td>
  <Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> | <A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <tr>
</table></div>



<!--start-->
	<div class="mainTitle" align="center">
	  <h1>Лекция № 3.21</h1>
</div>
	<div>
	  <h3 align="center"><strong>Раздел 3.  Программирование различных задач цифровой обработки сигналов на  проблемно-ориентированных процессорах</strong></h3>
      <p><strong>3.3&nbsp;&nbsp;&nbsp; Использование проблемно-ориентированных  процессоров для усреднения сигналов (4 часа)</strong> <br>
        <strong><em>Лекция № 3.21</em></strong><br>
        Программная реализация алгоритма  линейного усреднения для проблемно-ориентированных процессоров семейства  TMS320.<br>
        Программная реализация алгоритма  экспоненциального усреднения для проблемно-ориентированных процессоров  семейства TMS320.<br>
      </p>
</div>

<div align="center">
    <p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK20/lk_20.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK22/lk_22.htm'" />
    </p>
</div>

<!-- (C) 2017 Shemarov Alexander, BSUIR begin-->  

<div class="Text_Style"><h1>Использование проблемно-ориентированных процессоров для усреднения сигналов<br>
Программная реализация алгоритма линейного усреднения для проблемно-ориентированных процессоров </h1></div>
<div class="Text_Style"><h2>Линейное усреднение</h2></div>

<div class="Text_Style">
  <p>При определении средней величины, оценки  или действительного значения некоторого измеряемого параметра мы сталкиваемся с  проблемой искажения результата измерения случайными возмущениями реального мира.  Эти возмущения являются следствием, как природы измеряемых величин, так и погрешностей  наших измерительных приборов. Каждый раз, когда мы стараемся максимально точно измерить  некоторую физическую величину, мы получаем несколько различающиеся значения.  Эти случайные флуктуации называются шумом. Минимизировать шум можно с помощью усреднения.  Усреднение используется для улучшения точности измерений, обнаружения сигналов,  а также в схемах фильтров нижних частот. Математические основы усреднения позволяют  понять некоторые аспекты использования этого важного процесса. Для понимания  процессов усреднения мы будем использовать параметры математической статистики среднее  (математическое ожидание), дисперсия и среднеквадратическое отклонение. <br>
В цифровой обработке сигналов усреднение  часто используется в форме линейного усреднения, которое предполагает  суммирование отсчетов сигнала с последующим делением полученной суммы на  количество просуммированных отсчетов.<br>
Математически среднее N отсчетов последовательности х(n), обозначаемое как x<sub>ave</sub>,  записывается в виде: </p>
 
  <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
    <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for030301.png" width="572" height="78"></td>
          <td width="10%" valign="center" align="right">(3.3.1)</td>
    </tr>
  </table>

  <p>При изучении усреднения важным понятием является  понятие дисперсии последовательности &#963;<sup>2</sup>, определяемой  как: </p>
    <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
    <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for030302.png" width="732" height="154"></td>
          <td width="10%" valign="center" align="right">(3.3.2)</td>
    </tr>
  </table>
  <p>
    Дисперсия &#963;<sup>2</sup> позволяет  получить количественную меру того, насколько сильно значения отсчетов  последовательности флуктуируют относительно среднего значения. Это объясняется  тем, что, например, значение х(i)-xave в квадратных скобках представляет собой  разность значения текущего отсчета х(i) и среднего  значения x<sub>ave</sub>. <br>
    Другая важная величина, которую мы будем  использовать - это &#963; среднеквадратическое  отклонение (стандартное отклонение), которое определяется как положительное  значение квадратного корня из дисперсии, или:</p>
  <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
    <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for030303.png" width="272" height="87"></td>
          <td width="10%" valign="center" align="right">(3.3.3)</td>
    </tr>
  </table>
  <p>Другими словами, среднее значение xave представляет собой постоянный уровень,  относительно которого значения отдельных отсчетов могут изменяться. <br>
    Дисперсия &#963;<sup>2</sup> представляет  собой сумму квадратов отклонений отдельных отсчетов от среднего уровня x<sub>ave</sub>. Если  последовательность х(n) представляет  собой временной ряд или отсчеты сигнала, мы можем сказать, что xave определяет постоянную составляющую  сигнала, стандартное отклонение &#963;  отражает амплитуду флуктуации, или переменной составляющей сигнала, а дисперсия  &#963;<sup>2</sup> отражает мощность  переменной составляющей. </p>
  <p>Определение среднего в теории сигналов  носит название линейного усреднения. Линейное усреднение позволяет получить  среднее xave(N+1)  для N+1 отсчетов последовательности х(n) из среднего xave(N) для N отсчетов последовательности  х(n) согласно формуле 3.3.4.</p>

      <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
    <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for030304.png" width="658" height="231"></td>
          <td width="10%" valign="center" align="right">(3.3.4)</td>
    </tr>
  </table>  
  
  <p> А  это не позволяет использовать линейное усреднение для получения среднего  значения, изменяющегося в порядке поступления отсчетов последовательности х(n). Линейное усреднение применимо только для  определенного и относительно большого набора данных, что делает линейное  усреднение достаточно инерционным процессом.</p></div>
<div class="Text_Style"><h2>Алгоритм линейного усреднения</h2></div>

<div class="Text_Style">
<p>&nbsp;Алгоритм линейного усреднения представлен на рисунке 3.3.1. Усреднение осуществляется группами по N отсчетов в каждой группе.</p>

<h3 align="center"><a name="Рис3.3.1"></a><img src="../../images/Ris21_1.gif" alt="Рис.3.3.1" width="304" height="1176"></h3>
<h3 align="center">Рисунок 3.3.1 &ndash; Алгоритм линейного усреднения </h3>
</div> 

	<div class="Text_Style">
	  <h2>Программная реализация линейного усреднения</h2>
</div>
	<div class="Text_Style">
	<p>Пример программы  линейного усреднения случайного сигнала.</p>
	<blockquote>
	  <blockquote>
	    <pre>
				.mmregs 
				.def	_c_int00		; Определяем переменную, которая будет в дальнейшем использоваться как глобальная в других файлах
				.text					; Начинаем сегмент кода

Bufer_size		.equ	1024
Number_sample	.equ	40				


_c_int00:
		;		Метка начала программы
				ld		#GPRN_Start, DP
				stm		#Stack_Array, SP

		;		Формирование случайного процесса 
		;		Количество отсчетов равно Bufer_size	
				dld		GPRN_Start, A
				stm		#Random_Array, AR1
				stm		#Bufer_size-1, BRC	

				call	Random_M_Seq
				

		;		Усреднение случайного процесса м формирование усредненного сигнала
		;		Линейное усреднение осуществляется блоками по Number_sample отсчетов		
				stm		#Random_Array, AR2
				stm		#AVE_Random_Array, AR3
				ssbx	sxm
				rsbx	ovm
				
		;		Выполнение округления. Число блоков равно Bufer_size/Number_sample 
				ld		K, A
				stlm	A, BRC
				
				stm		#KOEF, AR4
				
				rptb	end_block_m2	

		;		Вычисление среднего значения по блоку		
				xor		A, A
				macsu	*AR4, *AR2+, A

		;		Округление среднего значения по блоку	
				xc		2, AGEQ
				add		#0x8000, A
				xc		2, ALT
				sub		#0x8000, A
				
		;		Запись среднего значения в блок		
				rpt		N	
end_block_m2:	sth		A, *AR3+
					
				nop												
																
																				
																											

				
; Подпрограмма для генерирования псевдослучайных чисел
; AR1 - адрес массива элементов в памяти
; BRC - количество элементов массива
Random_M_Seq:	rsbx	sxm
				rptb	end_block
				
				...

end_block:		stl		A, *AR1+

				ret
				
				nop
				nop
				
				
						
						
				.align
				.data

N        			.word		Number_sample-1
K        			.word		Bufer_size/Number_sample-1
KOEF				.word		32768/Number_sample
GPRN_Start			.long		0x000ABCDE
Random_Array		.space		Bufer_size*16
AVE_Random_Array	.space		Bufer_size*16
Stack_Array			.bes		128*16

				.end

    </pre>
      </blockquote>
	  </blockquote>
</div>
<div class="Text_Style"> <p>Результаты линейного усреднения случайного процесса представлены на рисунках 3.3.2а и 3.3.2б (длина блока 40 отсчетов) без изменеия масштаба по оси Y относительно исходного процесса и изменением масштаба по оси Y сооответственно. Результаты усреднения этого же случайного процесса процессы представлены на рисунке 3.2.3 (длина блока 18 отсчетов) и на рисунке 3.2.4 (длина блока 9 отсчетов).  </p></div>

<div>
<h3 align="center"><a name="Рис3.3.2а"></a><img src="../../images/Ris21_1ausr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.2а &ndash; Линейное усреднение случайного процесса блоками по 40 отсчетов </h3>
</div> 

<div>
<h3 align="center"><a name="Рис3.3.2б"></a><img src="../../images/Ris21_1usr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.2б &ndash; Линейное усреднение случайного процесса блоками по 40 отсчетов с zoom по оси Y </h3>
</div> 

<div>
<h3 align="center"><a name="Рис3.3.3"></a><img src="../../images/Ris21_2usr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.3 &ndash; Линейное усреднение случайного процесса блоками по 18 отсчетов </h3>
</div> 

<div>
<h3 align="center"><a name="Рис3.3.3"></a><img src="../../images/Ris21_3usr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.4 &ndash; Линейное усреднение случайного процесса блоками по 9 отсчетов </h3>
</div> 

<div class="Text_Style">
  <h1> Программная реализация алгоритма экспоненциального усреднения для проблемно-ориентированных процессоров </h1></div>
<div class="Text_Style">
  <h2>Экспоненциальное усреднение</h2></div>

<div class="Text_Style">
<p>Существует вид усреднения во временной  области, который используется в некоторых приборах, который позволяет существенно  уменьшить инерционность линейного усреднения. Этот вид усреднения называется экспоненциальным  усреднением.<br>
  Этот метод обеспечивает подавление шума  путем умножения входного отсчета на константу и сложения этого произведения с предыдущим  значением среднего, умноженным на дополнение константы до единицы. <br>
  Закон функционирования устройства использующего  экспоненциальное усреднение описывается формулой 3.3.5:</p>

      <table align="center" width="80%" border="0" cellspacing="0" cellpadding="0">
    <tr>
          <td width="10%" valign="top">&nbsp;</td>
          <td width="70%" valign="center" align="center"><img src="../../images/for030305.png" width="734" height="204"></td>
          <td width="10%" valign="center" align="right">(3.3.5)</td>
    </tr>
  </table>  

<p>Преимущество экспоненциального усреднения в том, что оно требует всего одну ячейку памяти для хранения значения x<sub>ave</sub>(n-1) до получения следующего входного отсчета x(n). 
Название усреднения происходит от его импульсной характеристики. Предположим, что на вход устройства усреднения поступает длинная последовательность нулей и в момент времени t = 0 подается на его вход один единичный отсчет. Затем входная последовательность снова представляет собой последовательность нулей. Выходная последовательность на выходе (импульсная характеристика) устройства усреднения представляет собой экспоненту с отрицательной степенью.<br>
Полезной особенностью устройства экспоненциального усреднения является то, что оно позволяет изменять степень подавления шума путем изменения значения весового коэффициента. Если постоянная времени &alpha; = 1, входные отсчеты не ослабляются, предыдущие отсчеты среднего не учитываются, и никакого усреднения не происходит.<br> 
В этом случае изменения входной последовательности передаются непосредственно на выход. Когда &alpha; уменьшается по величине, входные отсчеты ослабляются, предыдущие выходные отсчеты начинают влиять на значение текущего выходного отсчета. Эти предыдущие отсчеты представляют собой сумму экспоненциально взвешенных входных отсчетов, и такое суммирование сглаживает зашумленный сигнал. Чем меньше &alpha;, тем сильнее подавляется шум. С другой стороны, чем меньше &alpha;, тем медленнее устройство реагирует на изменения входного сигнала.<br>
Чем больше подавление шума, тем медленнее устройство усреднения будет реагировать на изменения входного сигнала. Для достижения компромисса между подавлением шума и временем установления выходного сигнала в начале измерения можно использовать большое значение &alpha;, так что выходной сигнал сразу принимает ненулевое значение. Затем, с течением времени, значение &alpha; уменьшается для достижения требуемого подавления шума.<br></p>
</div>

<div class="Text_Style"><h2>Алгоритм экспоненциального усреднения</h2></div>

<div class="Text_Style">
  <p>&nbsp;Алгоритм экспоненциального усреднения представлен на рисунке 3.3.5. Усреднение осуществляется по выборке, состоящей из N отсчетов.</p>

<h3 align="center"><a name="Рис3.3.<h5>1</h5>"></a><img src="../../images/Ris21_2.gif" width="276" height="739"></h3>
<h3 align="center">Рисунок 3.3.5 &ndash; Алгоритм экспоненциального усреднения </h3>
</div> 


	<div class="Text_Style">
	  <h2>Программная реализация экспоненциального усреднения</h2>
</div>
	<div class="Text_Style">
	<p>Пример программы  линейного усреднения случайного сигнала.</p>
	<blockquote>
	  <blockquote>
	    <pre>
				.mmregs 
				.def	_c_int00		; Определяем переменную, которая будет в дальнейшем использоваться как глобальная в других файлах
				.text					; Начинаем сегмент кода

Bufer_size		.equ	1024
KOEF_ALPHA		.equ	32768*10/100				


_c_int00:	 	; Метка начала программы
				ld		#GPRN_Start, DP
				stm		#Stack_Array, SP

		;		Формирование случайного процесса 
		;		Количество отсчетов равно Bufer_size	
				dld		GPRN_Start, A
				stm		#Random_Array, AR1
				stm		#Bufer_size-1, BRC	

				call	Random_M_Seq
				

		;		Усреднение случайного процесса м формирование усредненного сигнала
		;		Линейное усреднение осуществляется блоками по Number_sample отсчетов		
				stm		#Random_Array, AR2
				stm		#AVE_Random_Array, AR3
				ssbx	sxm
				rsbx	ovm
				
				; Устанавливаем первое значение в последовательности усредненных отсчетов

;				xor		A, A              ; если начальное значение нулевое
				ld		*AR2+, A          ; если начальное значение равно первому члену последовательности
				stl		A, *AR3		
				
		;		Выполнение округления. Число блоков равно Bufer_size/Number_sample 
				stm		#Bufer_size-2, BRC
				
				stm		#ALPHA, AR4
;				stm		#ONEMINALPHA, AR5
				
				rptb	end_block_m2	

		;		Вычисление очередного значения последовательности округленной по экспоненциальному закону		
				xor		A, A
				macsu	*AR4+, *AR2+, A
				macsu	*AR4-, *AR3+, A

		;		Округление среднего текущего среднего значения 	
				xc		2, AGEQ
				add		#0x8000, A
				xc		2, ALT
				sub		#0x8000, A
				
		;		Запись текущего экспоненциально усредненного значения последовательности		
	
end_block_m2:	sth		A, *AR3
					
				nop												
																
																				
																											

				
; Подпрограмма для генерирования псевдослучайных чисел
; AR1 - адрес массива элементов в памяти
; BRC - количество элементов массива
Random_M_Seq:	rsbx	sxm
				rptb	end_block
				
				ld		A, 3, B
				xor		B, A
				ld  	A, -16, B
				and 	#0x000F, B
				xor		B, -1, A
end_block:		stl		A, *AR1+

				ret
				
				nop
				nop
				
				
						
						
				.align
				.data


ALPHA				.word		KOEF_ALPHA			; Alpha
ONEMINALPHA			.word		32768 - KOEF_ALPHA	; 1-Alpha
GPRN_Start			.long		0x000ABCDE
Random_Array		.space		Bufer_size*16
AVE_Random_Array	.space		Bufer_size*16
Stack_Array			.bes		128*16

				.end
    </pre>
      </blockquote>
	  </blockquote>
</div>


<div class="Text_Style"> <p>Результаты экспоненциального усреднения случайного процесса представлены на рисунках 3.3.6 (коэффициент &amp;alpha; = 0,3) и 3.3.7а и 3.3.7б (коэффициент &amp;alpha; = 0,1). Рисунок 3.3.7а - без изменеия масштаба по оси Y относительно исходного процесса и рисунок 3.3.7б - изменением масштаба по оси Y сооответственно. </p></div>

<div>
<h3 align="center"><a name="Рис3.3.6"></a><img src="../../images/Ris21_4usr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.6 &ndash; Экспоненциальное усреднение случайного процесса (коэффициент &alpha; = 0,3)</h3>
</div> 

<div>
<h3 align="center"><a name="Рис3.3.7а"></a><img src="../../images/Ris21_5usr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.7а &ndash; Экспоненциальное усреднение случайного процесса (коэффициент &alpha; = 0,1) </h3>
</div> 

<div>
<h3 align="center"><a name="Рис3.3.7б"></a><img src="../../images/Ris21_5ausr.jpg" width="90%"></h3>
<h3 align="center">Рисунок 3.3.7б &ndash; Экспоненциальное усреднение случайного процесса (коэффициент &alpha; = 0,1) с zoom по оси Y </h3>
</div> 



<!-- (C) 2017 Shemarov Alexander, BSUIR end-->  

<div align="center">
	<p>
	<input type="button" class="buttonManage" value="&nbsp;Назад&nbsp;" onClick="document.location.href ='../LK20/lk_20.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Перечень тем лекций&nbsp;" onClick="document.location.href ='../../theory.htm'" />
	<input type="button" class="buttonManage" value="&nbsp;Вперед&nbsp;" onClick="document.location.href ='../LK22/lk_22.htm'" />
    </p>
  
<div class="Text_Style"><br></div>
</div>




<!--end-->
<div class="Header_Style">
<table width="100%" border="0" cellpadding="0" cellspacing="3" bordercolor="#316AC5" background="../../../Оболочка/images/background.jpg">
	<Tr>
    <td align=center colspan=2><var class="Header_Style"><A HREF="../../../index.htm">Оглавление</A> | <A HREF="../../../Программа/ППОВСРВ_программа_2017.htm" >Программа</A> | <a href="../../../Теория/theory.htm">Теория</a> | <a href="../../../Практика/practice.htm">Практика</a> |<A HREF="../../../Контроль_знаний/test.htm">Контроль знаний</A> | <A HREF="../../../Об авторах/author.htm">Об авторах</A></var></var> </td>
  <Tr>
   <td align=center><a href="https://www.bsuir.by/" title="Официальный сайт БГУИР" target="_blank">(С) БГУИР</a></td>
  </tr>
</table></div>

</BODY></HTML>