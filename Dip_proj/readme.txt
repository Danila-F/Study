Дань, а добился того, что заработало шифрование. На рабочем столе лежит файл - workin_encryption.ino

Но алгоритм сам надо дорабатывать.
Почему-то Serial.available() как будто всегда >0 и оно всегда что-то оттуда считывает.

Что я поменял:
- убрал выделение памяти для структур состояния
- сделал структуры состояния глобальными (без указателей)
- передаю стркутуры в фунции через взятие указателя (&)
- outData и input - типа char (тоже без указателя)
- предаю в функции &outData и &input, там где нужен указатель